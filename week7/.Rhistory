scale_color_continuous(labels = c("20-29","30-39","40-49","50-59","60-69","70-79"))
agePCA <- plotPCA(vsd, intgroup = "AGE") +
theme_base(base_size = 10) +
labs(title="PCA Analysis of Expression by Age",color="Age Group") +
scale_color_continuous(labels = c("20-29","30-39","40-49","50-59","60-69","70-79"))
plotPCA(vsd, intgroup = "DTHHRDY") +
theme_base(base_size = 10) +
labs(title="PCA Analysis of Expression by Cause of Death",color="Cause of Death") +
scale_color_colorblind()
plotPCA(vsd, intgroup = "DTHHRDY") +
theme_base(base_size = 10) +
labs(title="PCA Analysis of Expression by Cause of Death",color="Cause of Death") +
scale_color_colorblind(labels = c("Natural Causes","Death on Ventilator"))
codPCA <- plotPCA(vsd, intgroup = "DTHHRDY") +
theme_base(base_size = 10) +
labs(title="PCA Analysis of Expression by Cause of Death",color="Cause of Death") +
scale_color_colorblind(labels = c("Natural Causes","Death on Ventilator"))
ggsave("ex1sexPCA",sexPCA)
ggsave("ex1sexPCA.png",sexPCA)
ggsave("ex1agePCA.png",agePCA)
ggsave("ex1codPCA.png",codPCA)
library(broom)
# Confirm metadata and column names in the counts are the same
table(colnames(counts_df) == rownames(metadata_df))
source("~/qbb2024-answers/week7/homeworkWeek7.R", echo=TRUE)
# Question 2
vsd_df <- assay(vsd) %>%
t() %>%
as_tibble()
vsd_df <- bind_cols(metadata_df, vsd_df)
m1 <- lm(formula = WASH7P ~ DTHHRDY + AGE + SEX, data = vsd_df) %>%
summary() %>%
tidy()
View(m1)
# Perform multiple linear regression of WASH7P
m1 <- lm(formula = WASH7P ~ DTHHRDY + AGE + SEX, data = vsd_df) %>%
summary() %>%
tidy()
# Perform multiple linear regression of WASH7P
WASH7Pmodel <- lm(formula = WASH7P ~ DTHHRDY + AGE + SEX, data = vsd_df) %>%
summary() %>%
tidy()
source("~/qbb2024-answers/week7/homeworkWeek7.R", echo=TRUE)
View(WASH7Pmodel)
# Question 2.1.2
# Perform multiple linear regression of WASH7P
SLC25A47model <- lm(formula = SLC25A47 ~ DTHHRDY + AGE + SEX, data = vsd_df) %>%
summary() %>%
tidy()
View(SLC25A47model)
View(sexPCA)
# Question 2.2
# use DESeq2 to perform differential expression analysis across all genes
dds <- DESeq(dds)
resSEX <- results(dds, name = "SEX_male_vs_female")  %>%
as_tibble(rownames = "GENE_NAME")
View(resSEX)
# Filter out NA values from the results
resSEX <- resSEX %>%
filter(!is.na(padj)) %>%
arrange(padj)
View(resSEX)
# Filter for only padj values below 0.1 to select all samples where FDR = 10%
resSEX <- resSEX %>%
filter(padj < 0.1) %>%
arrange(padj)
View(resSEX)
len(resSEX)
length(resSEX)
size(resSEX)
shape(resSEX)
dim(resSEX)
dim(resSEX)[0]
dim(resSEX,0)
dim(resSEX)[1]
View(sexPCA)
View(resSEX)
# Question 2.3.3
gene_loc = read.delim("gene_locations.txt")
View(gene_loc)
left_join(gene_loc,resSEX,by="GENE_ID")
View(resSEX)
View(gene_loc)
deGenesByLocation = left_join(gene_loc,resSEX,by="GENE_NAME") %>% arrange(padj)
View(deGenesByLocation)
View(deGenesByLocation)
View(dds)
# Question 2.3.4
WASH7DESeq = deGenesByLocation %>% filter(GENE_NAME == "WASH7")
View(WASH7DESeq)
SLC25A47DESeq = deGenesByLocation %>% filter(GENE_NAME == "SLC25A47")
View(SLC25A47DESeq)
# Question 2.4.1
resCOD <- results(dds, name = "DTHHRDY_ventilator_case_vs_fast_death_of_natural_causes")  %>%
as_tibble(rownames = "GENE_NAME")
resCOD <- resCOD %>%
filter(!is.na(padj)) %>%
arrange(padj)
resCOD <- resCOD %>%
filter(padj < 0.1) %>%
arrange(padj)
dim(resCOD)[1]
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_ID), size = 3,) +
theme_bw() +
theme(legend.position = "none") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("fold change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_bw() +
theme(legend.position = "none") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("fold change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("fold change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex",color="Significant Expression")
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex")
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("fold change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("fold change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 3,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 1,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1)) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),dashed) +
geom_line(mapping = aes(-1)) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),"dashed") +
geom_line(mapping = aes(-1)) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1)) +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=0.1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & pvalue < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & pvalue < 1e-50),
aes(x = log2FoldChange, y = -log10(pvalue) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("p-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 2 & padj < 1e-20))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(pvalue))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & padj < 0.1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & padj < 0.1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & padj < 0.1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & padj < 0.1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)<-1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
-log10(0.1)
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)<1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & padj < 1e-50),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)<1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 1 & -log10(padj) < 1),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 1 & -log10(padj) > 1),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 2),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 3),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 100),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=10),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
# Question 3
ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 100),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
ggsave("ex3volcanoPlot.png",volcanoPlot)
# Question 3
volcanoPlot = ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 100),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj-value")), x = expression(log[2]("Fold Change")))
ggsave("ex3volcanoPlot.png",volcanoPlot)
# Question 3
volcanoPlot = ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 100),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj")), x = expression(log[2]("Fold Change")))
ggsave("ex3volcanoPlot.png",volcanoPlot)
source("~/qbb2024-answers/week7/homeworkWeek7.R", echo=TRUE)
# Question 3
volcanoPlot = ggplot(data = resSEX, aes(x = log2FoldChange, y = -log10(padj))) +
geom_point(aes(color = (abs(log2FoldChange) > 1 & -log10(padj)>1))) +
geom_text(data = resSEX %>% filter(abs(log2FoldChange) > 2 & -log10(padj) > 10),
aes(x = log2FoldChange, y = -log10(padj) + 5, label = GENE_NAME), size = 2,) +
theme_base(base_size = 10) +
geom_line(mapping = aes(1),linetype = "dashed") +
geom_line(mapping = aes(-1),linetype = "dashed") +
geom_line(mapping = aes(y=1),linetype = "dashed") +
theme(legend.position = "none") +
labs(title="Volcano Plot of Differential Expression by Sex") +
scale_color_colorblind() +
labs(y = expression(-log[10]("padj")), x = expression(log[2]("Fold Change")))
ggsave("ex3volcanoPlot.png",volcanoPlot)
